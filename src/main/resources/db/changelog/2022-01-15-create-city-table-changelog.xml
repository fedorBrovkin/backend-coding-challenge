<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
         http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.8.xsd">

    <changeSet id="create-cities_canada_usa-table" author="fedor.brovkin" dbms="postgresql">

        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists tableName="cities_canada_usa"/>
            </not>
        </preConditions>

        <sql>

            CREATE TABLE IF NOT EXISTS cities_canada_usa
            (
            id BIGSERIAL NOT NULL
            CONSTRAINT "cities_canada_usa_pk"
            PRIMARY KEY,
            geo_names_id INTEGER,
            ascii TEXT,
            alt_name TEXT,
            lat NUMERIC,
            long NUMERIC,
            name TEXT,
            feat_code VARCHAR(10),
            country CHAR(2),
            cc2 TEXT,
            feat_class CHAR(1),
            admin2 VARCHAR(80),
            admin3 VARCHAR(20),
            admin4 VARCHAR(20),
            admin1 VARCHAR(20),
            elevation INTEGER,
            dem INTEGER,
            tz VARCHAR(40),
            modified_at DATE,
            population INTEGER
            );

            CREATE UNIQUE INDEX IF NOT EXISTS cities_canada_usa_geo_names_id_uindex
            ON cities_canada_usa (geo_names_id);

            CREATE INDEX IF NOT EXISTS cities_canada_usa_ascii_index
            ON cities_canada_usa (ascii);

            CREATE INDEX IF NOT EXISTS cities_canada_usa_alt_name_index
            ON cities_canada_usa (alt_name);

            CREATE INDEX IF NOT EXISTS cities_canada_usa_lat_index
            ON cities_canada_usa (lat);

            CREATE INDEX IF NOT EXISTS cities_canada_usa_long_index
            ON cities_canada_usa (long);

            CREATE INDEX IF NOT EXISTS cities_canada_usa_name_index
            ON cities_canada_usa (name);
        </sql>
        <rollback>
            <dropTable tableName="cities_canada_usa"/>
        </rollback>
    </changeSet>

</databaseChangeLog>